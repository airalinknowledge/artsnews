<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‰ºæœ¯æœºæ„åŠ¨æ€ç›‘æ§å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
        }

        .nav-tab.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        /* ä¸»é¡µæ ·å¼ */
        .status-bar {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #38a169;
            animation: pulse 2s infinite;
        }

        .status-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-bar {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-item {
            background: #f0f4f8;
            color: #4a5568;
            padding: 6px 12px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .filter-item.active {
            background: #667eea;
            color: white;
        }

        .updates-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 14px;
        }

        .update-item {
            background: #ffffff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #38a169;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .update-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .update-item.exhibition {
            border-left-color: #38a169;
        }

        .update-item.event {
            border-left-color: #3182ce;
        }

        .update-item.news {
            border-left-color: #d69e2e;
        }

        .update-item.email {
            border-left-color: #805ad5;
        }

        .update-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .update-source {
            font-weight: 600;
            color: #38a169;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .update-type {
            background: #f0f4f8;
            color: #4a5568;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .real-data-badge {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 6px;
            animation: pulse 2s infinite;
        }

        .demo-data-badge {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 6px;
        }

        .update-time {
            color: #718096;
            font-size: 0.9rem;
        }

        .update-content {
            color: #4a5568;
            line-height: 1.6;
        }

        .update-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .update-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
        }

        .update-link:hover {
            text-decoration: underline;
        }

        /* è®¾ç½®é¡µé¢æ ·å¼ */
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }

        .btn-secondary {
            background: #f7fafc;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }

        .institutions-list h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #4a5568;
        }

        .institution-item {
            background: #f7fafc;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .institution-item h4 {
            color: #2d3748;
            margin-bottom: 5px;
        }

        .institution-item p {
            color: #718096;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .institution-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        .empty-state p {
            margin-bottom: 20px;
        }

        .info-box {
            background: #f0fff4;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #38a169;
            margin-top: 20px;
        }

        .info-box h4 {
            color: #38a169;
            margin-bottom: 8px;
        }

        .info-box ul {
            color: #2f855a;
            padding-left: 20px;
        }

        .info-box li {
            margin-bottom: 4px;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .status-bar, .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .nav-tab {
                font-size: 14px;
                padding: 10px 16px;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
        }

        .modal h3 {
            margin-bottom: 20px;
            color: #4a5568;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¨ è‰ºæœ¯æœºæ„åŠ¨æ€ç›‘æ§å™¨</h1>
            <p>è‡ªåŠ¨è¿½è¸ªä½ å…³æ³¨çš„è‰ºæœ¯æœºæ„æœ€æ–°åŠ¨æ€ï¼Œæ— éœ€é€ä¸€æŸ¥çœ‹</p>
            <div style="background: rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 10px; margin-top: 15px; font-size: 14px;">
                ğŸ’¡ <strong>æ¼”ç¤ºç‰ˆæœ¬</strong>ï¼šåœ¨ Claude.ai ç¯å¢ƒä¸­è¿è¡Œï¼Œæ•°æ®ä»…åœ¨å½“å‰ä¼šè¯ä¿å­˜ï¼Œåˆ·æ–°é¡µé¢åé‡ç½®
            </div>
        </div>

        <!-- å¯¼èˆªæ ‡ç­¾ -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchPage('home')">ğŸ“° æœ€æ–°åŠ¨æ€</button>
            <button class="nav-tab" onclick="switchPage('settings')">âš™ï¸ è®¾ç½®ç®¡ç†</button>
        </div>

        <!-- ä¸»é¡µ - æœ€æ–°åŠ¨æ€ -->
        <div id="homePage" class="page active">
            <div class="status-bar">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>ç›‘æ§ä¸­...</span>
                    <span style="color: #718096; margin-left: 10px;" id="monitoringCount">ç›‘æ§ 0 ä¸ªæœºæ„</span>
                </div>
                <div class="status-actions">
                    <span id="lastUpdate">æœ€åæ›´æ–°ï¼šåˆšåˆš</span>
                    <button class="btn btn-small" onclick="manualUpdate()">ğŸ”„ æ‰‹åŠ¨åˆ·æ–°</button>
                </div>
            </div>

            <div class="updates-stats">
                <div class="stat-card">
                    <div class="stat-number" id="todayUpdates">0</div>
                    <div class="stat-label">ä»Šæ—¥æ–°åŠ¨æ€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalUpdates">0</div>
                    <div class="stat-label">æ€»åŠ¨æ€æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activeInstitutions">0</div>
                    <div class="stat-label">æ´»è·ƒæœºæ„</div>
                </div>
            </div>

            <div class="filter-bar">
                <span>ç­›é€‰ï¼š</span>
                <button class="filter-item active" data-filter="all">å…¨éƒ¨</button>
                <button class="filter-item" data-filter="exhibition">å±•è§ˆ</button>
                <button class="filter-item" data-filter="event">æ´»åŠ¨</button>
                <button class="filter-item" data-filter="news">æ–°é—»</button>
                <button class="filter-item" data-filter="email">é‚®ä»¶</button>
            </div>

            <div class="card">
                <div class="quick-actions">
                    <button class="btn btn-small" onclick="switchPage('settings')">â• æ·»åŠ æœºæ„</button>
                    <button class="btn btn-small btn-secondary" onclick="markAllRead()">âœ“ å…¨éƒ¨å·²è¯»</button>
                    <button class="btn btn-small btn-secondary" onclick="exportUpdates()">ğŸ“¤ å¯¼å‡º</button>
                </div>
                
                <div id="updatesFeed">
                    <!-- åŠ¨æ€æ›´æ–°å†…å®¹ -->
                </div>
            </div>
        </div>

        <!-- è®¾ç½®é¡µé¢ -->
        <div id="settingsPage" class="page">
            <div class="settings-grid">
                <!-- æ·»åŠ æœºæ„ -->
                <div class="card">
                    <h2>â• æ·»åŠ è‰ºæœ¯æœºæ„</h2>
                    <form id="addInstitutionForm">
                        <div class="form-group">
                            <label for="institutionName">æœºæ„åç§°</label>
                            <input type="text" id="institutionName" placeholder="ä¾‹å¦‚ï¼šä¸­å›½ç¾æœ¯é¦†" required>
                        </div>
                        <div class="form-group">
                            <label for="institutionUrl">ç½‘ç«™URL</label>
                            <input type="url" id="institutionUrl" placeholder="https://www.namoc.org" required>
                        </div>
                        <div class="form-group">
                            <label for="institutionKeywords">å…³é”®è¯ï¼ˆå¯é€‰ï¼‰</label>
                            <input type="text" id="institutionKeywords" placeholder="ä¾‹å¦‚ï¼šå±•è§ˆ, è‰ºæœ¯, å½“ä»£">
                        </div>
                        <div class="form-group">
                            <label for="checkFrequency">æ£€æŸ¥é¢‘ç‡</label>
                            <select id="checkFrequency">
                                <option value="15">æ¯15åˆ†é’Ÿ</option>
                                <option value="30" selected>æ¯30åˆ†é’Ÿ</option>
                                <option value="60">æ¯å°æ—¶</option>
                                <option value="180">æ¯3å°æ—¶</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">æ·»åŠ ç›‘æ§</button>
                    
                    <div class="info-box">
                        <h4>ğŸ“¡ RSS é…ç½®è¯´æ˜</h4>
                        <ul>
                            <li>ç³»ç»Ÿä¼šè‡ªåŠ¨æ¨æ–­å¸¸è§è‰ºæœ¯æœºæ„çš„ RSS åœ°å€</li>
                            <li>ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨è¾“å…¥ç‰¹å®šçš„ RSS åœ°å€</li>
                            <li>æ”¯æŒçš„æ ¼å¼ï¼šRSS 2.0, Atom, JSON Feed</li>
                            <li>ä½¿ç”¨"æµ‹è¯•RSS"æŒ‰é’®éªŒè¯è¿æ¥æ˜¯å¦æ­£å¸¸</li>
                        </ul>
                    </div>
                    </form>
                </div>

                <!-- é‚®ä»¶é›†æˆ -->
                <div class="card">
                    <h2>ğŸ“§ é‚®ä»¶é›†æˆè®¾ç½®</h2>
                    <p style="margin-bottom: 15px; color: #718096;">è¿æ¥ä½ çš„é‚®ç®±ä»¥è‡ªåŠ¨æ¥æ”¶æœºæ„é€šçŸ¥</p>
                    
                    <div class="form-group">
                        <label>é‚®ç®±æœåŠ¡</label>
                        <select id="emailProvider">
                            <option>é€‰æ‹©é‚®ç®±æœåŠ¡</option>
                            <option>Gmail</option>
                            <option>Outlook</option>
                            <option>163é‚®ç®±</option>
                            <option>QQé‚®ç®±</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>é‚®ä»¶è¿‡æ»¤å…³é”®è¯</label>
                        <input type="text" id="emailKeywords" placeholder="å±•è§ˆ, è‰ºæœ¯, ç”»å»Š, ç¾æœ¯é¦†">
                    </div>
                    
                    <button class="btn" onclick="setupEmail()">ğŸ”— è®¾ç½®é‚®ä»¶é›†æˆ</button>
                    
                    <button class="btn" onclick="setupEmail()">ğŸ”— è®¾ç½®é‚®ä»¶é›†æˆ</button>
                    
                    <div class="info-box">
                        <h4>ğŸ’¡ é‚®ä»¶é›†æˆè¯´æ˜</h4>
                        <ul>
                            <li>è‡ªåŠ¨è¯†åˆ«è‰ºæœ¯æœºæ„å‘é€çš„é‚®ä»¶</li>
                            <li>æå–å±•è§ˆã€æ´»åŠ¨ç­‰é‡è¦ä¿¡æ¯</li>
                            <li>æ”¯æŒå¤šä¸ªé‚®ç®±è´¦æˆ·</li>
                            <li>ä¿æŠ¤éšç§ï¼Œä»…æœ¬åœ°å¤„ç†</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- æœºæ„ç®¡ç† -->
            <div class="card">
                <h2>ğŸ›ï¸ æœºæ„ç®¡ç†</h2>
                <div id="institutionsList">
                    <!-- åŠ¨æ€æ·»åŠ çš„æœºæ„åˆ—è¡¨ -->
                </div>
            </div>

            <!-- é«˜çº§è®¾ç½® -->
            <div class="card">
                <h2>ğŸ”§ é«˜çº§è®¾ç½®</h2>
                <div class="settings-grid">
                    <div>
                        <h4 style="margin-bottom: 15px; color: #4a5568;">é€šçŸ¥è®¾ç½®</h4>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableNotifications" checked> 
                                å¯ç”¨æ¡Œé¢é€šçŸ¥
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableSounds" checked> 
                                æ’­æ”¾æç¤ºéŸ³
                            </label>
                        </div>
                        <div class="form-group">
                            <label>é€šçŸ¥é¢‘ç‡</label>
                            <select id="notificationFrequency">
                                <option>å®æ—¶é€šçŸ¥</option>
                                <option>æ¯å°æ—¶æ±‡æ€»</option>
                                <option>æ¯æ—¥æ±‡æ€»</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 15px; color: #4a5568;">æ•°æ®ç®¡ç†</h4>
                        <div class="form-group">
                            <button class="btn btn-secondary" onclick="exportData()">ğŸ“¤ å¯¼å‡ºæ•°æ®</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" onclick="importData()">ğŸ“¥ å¯¼å…¥æ•°æ®</button>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- é‚®ä»¶è®¾ç½®æ¨¡æ€æ¡† -->
    <div id="emailModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h3>é‚®ä»¶é›†æˆè®¾ç½®</h3>
            <p style="margin-bottom: 20px; color: #718096;">
                ä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨OAuthè®¤è¯æ–¹å¼è¿æ¥ä½ çš„é‚®ç®±ã€‚ä½ çš„å¯†ç ä¸ä¼šè¢«å­˜å‚¨ã€‚
            </p>
            <div class="form-group">
                <label>é‚®ç®±åœ°å€</label>
                <input type="email" id="modalEmail" placeholder="your@email.com">
            </div>
            <div class="form-group">
                <label>è¿‡æ»¤å…³é”®è¯</label>
                <input type="text" id="modalKeywords" placeholder="å±•è§ˆ,è‰ºæœ¯,ç”»å»Š,ç¾æœ¯é¦†">
            </div>
            <div class="form-group">
                <label>æ£€æŸ¥é¢‘ç‡</label>
                <select id="modalEmailFrequency">
                    <option>æ¯15åˆ†é’Ÿ</option>
                    <option selected>æ¯30åˆ†é’Ÿ</option>
                    <option>æ¯å°æ—¶</option>
                </select>
            </div>
            <button class="btn" onclick="connectEmail()">ğŸ”— æˆæƒè¿æ¥</button>
        </div>
    </div>

    <script>
        // å­˜å‚¨æ•°æ®ï¼ˆä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œé€‚é… Claude.ai artifacts ç¯å¢ƒï¼‰
        let institutions = [];
        let updates = [];
        let currentFilter = 'all';

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('å¼€å§‹åˆå§‹åŒ–...');
                
                renderInstitutions();
                renderUpdates();
                updateStats();
                updateRssInstitutionSelect();
                setupFilters();
                
                // å¦‚æœæ²¡æœ‰æœºæ„ï¼Œæ˜¾ç¤ºè®¾ç½®é¡µé¢
                if (institutions.length === 0) {
                    console.log('æ²¡æœ‰æœºæ„ï¼Œåˆ‡æ¢åˆ°è®¾ç½®é¡µé¢');
                    switchPage('settings');
                }
                
                console.log('åˆå§‹åŒ–å®Œæˆ');
            } catch (error) {
                console.error('åˆå§‹åŒ–æ—¶å‡ºé”™:', error);
                showNotification('âŒ åˆå§‹åŒ–å¤±è´¥: ' + error.message);
            }
        });

        // é¡µé¢åˆ‡æ¢
        function switchPage(page) {
            // æ›´æ–°å¯¼èˆª
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ‰¾åˆ°å¯¹åº”çš„æ ‡ç­¾å¹¶æ¿€æ´»
            document.querySelectorAll('.nav-tab').forEach(tab => {
                if ((page === 'home' && tab.textContent.includes('æœ€æ–°åŠ¨æ€')) ||
                    (page === 'settings' && tab.textContent.includes('è®¾ç½®ç®¡ç†'))) {
                    tab.classList.add('active');
                }
            });
            
            // åˆ‡æ¢é¡µé¢
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
            });
            document.getElementById(page + 'Page').classList.add('active');
        }

        // è®¾ç½®è¿‡æ»¤å™¨
        function setupFilters() {
            document.querySelectorAll('.filter-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.filter-item').forEach(f => f.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderUpdates();
                });
            });
        }

        // æ·»åŠ æœºæ„
        document.getElementById('addInstitutionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            console.log('è¡¨å•æäº¤å¼€å§‹...');
            
            const name = document.getElementById('institutionName').value;
            const url = document.getElementById('institutionUrl').value;
            const keywords = document.getElementById('institutionKeywords').value;
            const rssUrl = document.getElementById('institutionRss').value;
            const frequency = document.getElementById('checkFrequency').value;
            
            // è°ƒè¯•è¾“å‡º
            console.log('è¡¨å•æ•°æ®:', { name, url, keywords, rssUrl, frequency });
            
            // åŸºæœ¬éªŒè¯
            if (!name.trim()) {
                showNotification('âŒ è¯·è¾“å…¥æœºæ„åç§°');
                return;
            }
            
            if (!url.trim()) {
                showNotification('âŒ è¯·è¾“å…¥ç½‘ç«™URL');
                return;
            }
            
            try {
                const institution = {
                    id: Date.now(),
                    name: name.trim(),
                    url: url.trim(),
                    keywords: keywords.trim(),
                    rssUrl: rssUrl.trim() || null,
                    frequency: parseInt(frequency),
                    lastChecked: new Date().toISOString(),
                    status: 'active',
                    updateCount: 0
                };
                
                console.log('åˆ›å»ºæœºæ„å¯¹è±¡:', institution);
                
                institutions.push(institution);
                // æ³¨æ„ï¼šåœ¨ Claude.ai artifacts ä¸­æ•°æ®åªåœ¨å½“å‰ä¼šè¯ä¿å­˜
                
                console.log('ä¿å­˜åˆ°å†…å­˜æˆåŠŸï¼Œå½“å‰æœºæ„æ•°é‡:', institutions.length);
                
                renderInstitutions();
                updateStats();
                this.reset();
                
                // ç«‹å³æ£€æŸ¥
                simulateCheck(institution);
                showNotification(`âœ… å·²æ·»åŠ  ${name} åˆ°ç›‘æ§åˆ—è¡¨`);
                
                console.log('æ·»åŠ æœºæ„å®Œæˆ');
                
            } catch (error) {
                console.error('æ·»åŠ æœºæ„æ—¶å‡ºé”™:', error);
                showNotification(`âŒ æ·»åŠ å¤±è´¥: ${error.message}`);
            }
        });

        // æ¸²æŸ“æœºæ„åˆ—è¡¨
        function renderInstitutions() {
            const container = document.getElementById('institutionsList');
            
            if (institutions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ›ï¸ è¿˜æ²¡æœ‰æ·»åŠ ä»»ä½•æœºæ„</h3>
                        <p>æ·»åŠ ä½ å…³æ³¨çš„è‰ºæœ¯æœºæ„å¼€å§‹ç›‘æ§</p>
                        <button class="btn" onclick="switchPage('settings')">ç«‹å³æ·»åŠ </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = institutions.map(institution => `
                <div class="institution-item">
                    <h4>${institution.name}</h4>
                    <p>ğŸŒ ${institution.url}</p>
                    <p>ğŸ·ï¸ å…³é”®è¯ï¼š${institution.keywords || 'æ— '}</p>
                    <p>ğŸ“¡ RSSæ•°æ®ï¼š${institution.hasRssData ? 
                        `<span style="color: #38a169;">âœ… å·²å¯¼å…¥çœŸå®æ•°æ®</span>` : 
                        `<span style="color: #f56565;">âŒ æœªå¯¼å…¥ï¼ˆä»…æ¨¡æ‹Ÿæ•°æ®ï¼‰</span>`}</p>
                    <p>â° æ£€æŸ¥é¢‘ç‡ï¼šæ¯${institution.frequency}åˆ†é’Ÿ</p>
                    <p>ğŸ“Š å‘ç°åŠ¨æ€ï¼š${institution.updateCount || 0} æ¡</p>
                    <p>ğŸ• æœ€åæ£€æŸ¥ï¼š${new Date(institution.lastChecked).toLocaleString()}</p>
                    <div class="institution-actions">
                        <button class="btn btn-small" onclick="generateSampleData(${institution.id})">ç”Ÿæˆç¤ºä¾‹</button>
                        <button class="btn btn-small btn-secondary" onclick="editInstitution(${institution.id})">ç¼–è¾‘</button>
                        <button class="btn btn-small btn-danger" onclick="removeInstitution(${institution.id})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        // æ¸²æŸ“æ›´æ–°åŠ¨æ€
        function renderUpdates() {
            const container = document.getElementById('updatesFeed');
            
            // æ ¹æ®è¿‡æ»¤å™¨ç­›é€‰
            let filteredUpdates = updates;
            if (currentFilter !== 'all') {
                filteredUpdates = updates.filter(update => update.type === currentFilter);
            }
            
            if (filteredUpdates.length === 0) {
                const emptyMessage = currentFilter === 'all' 
                    ? 'ğŸ” ç­‰å¾…å‘ç°æ–°åŠ¨æ€...' 
                    : `ğŸ“‚ æš‚æ— ${getFilterName(currentFilter)}ç±»å‹çš„åŠ¨æ€`;
                    
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>${emptyMessage}</h3>
                        <p>ç³»ç»Ÿæ­£åœ¨ç›‘æ§ä¸­ï¼Œæœ‰æ–°å†…å®¹ä¼šè‡ªåŠ¨æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                        ${institutions.length === 0 ? '<button class="btn" onclick="switchPage(\'settings\')">æ·»åŠ æœºæ„å¼€å§‹ç›‘æ§</button>' : ''}
                    </div>
                `;
                return;
            }
            
            // æŒ‰æ—¶é—´æ’åº
            const sortedUpdates = filteredUpdates.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            container.innerHTML = sortedUpdates.map(update => `
                <div class="update-item ${update.type}">
                    <div class="update-header">
                        <div class="update-source">
                            ${getTypeIcon(update.type)} ${update.source}
                            <span class="update-type">${getFilterName(update.type)}</span>
                            ${update.isRealData === true ? '<span class="real-data-badge">ğŸ”´ LIVE</span>' : 
                              update.isRealData === false ? '<span class="demo-data-badge">ğŸŸ¡ DEMO</span>' : ''}
                        </div>
                        <div class="update-time">${formatTime(update.timestamp)}</div>
                    </div>
                    <div class="update-title">${update.title}</div>
                    <div class="update-content">
                        ${update.content}
                        ${update.link ? `<a href="${update.link}" target="_blank" class="update-link">æŸ¥çœ‹è¯¦æƒ… â†’</a>` : ''}
                    </div>
                </div>
            `).join('');
        }

        // è·å–ç±»å‹å›¾æ ‡
        function getTypeIcon(type) {
            const icons = {
                exhibition: 'ğŸ¨',
                event: 'ğŸ“…',
                news: 'ğŸ“°',
                email: 'ğŸ“§'
            };
            return icons[type] || 'ğŸ“„';
        }

        // è·å–è¿‡æ»¤å™¨åç§°
        function getFilterName(filter) {
            const names = {
                exhibition: 'å±•è§ˆ',
                event: 'æ´»åŠ¨',
                news: 'æ–°é—»',
                email: 'é‚®ä»¶'
            };
            return names[filter] || filter;
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const today = new Date().toDateString();
            const todayUpdates = updates.filter(update => 
                new Date(update.timestamp).toDateString() === today
            ).length;
            
            document.getElementById('todayUpdates').textContent = todayUpdates;
            document.getElementById('totalUpdates').textContent = updates.length;
            document.getElementById('activeInstitutions').textContent = institutions.length;
            document.getElementById('monitoringCount').textContent = `ç›‘æ§ ${institutions.length} ä¸ªæœºæ„`;
        }

        // åˆ é™¤æœºæ„
        function removeInstitution(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæœºæ„çš„ç›‘æ§å—ï¼Ÿç›¸å…³çš„åŠ¨æ€è®°å½•ä¹Ÿä¼šè¢«åˆ é™¤ã€‚')) {
                const institution = institutions.find(inst => inst.id === id);
                institutions = institutions.filter(inst => inst.id !== id);
                // åˆ é™¤ç›¸å…³åŠ¨æ€
                updates = updates.filter(update => update.source !== institution.name);
                
                // åœ¨ Claude.ai artifacts ä¸­æ•°æ®åªä¿å­˜åœ¨å†…å­˜
                renderInstitutions();
                renderUpdates();
                updateStats();
                showNotification(`ğŸ—‘ï¸ å·²åˆ é™¤ ${institution.name}`);
            }
        }

        // ç”Ÿæˆç¤ºä¾‹æ•°æ®ï¼ˆæ›¿ä»£è‡ªåŠ¨æ£€æŸ¥ï¼‰
        function generateSampleData(id) {
            const institution = institutions.find(inst => inst.id === id);
            if (!institution) return;
            
            showNotification(`ğŸ­ ä¸º ${institution.name} ç”Ÿæˆç¤ºä¾‹æ•°æ®...`);
            
            const sampleUpdates = [
                {
                    title: "æ–°å±•è§ˆï¼šå½“ä»£è‰ºæœ¯ç²¾å“å±•",
                    content: "å±•å‡º20ä¸–çºªè‡³ä»Šçš„è‰ºæœ¯ç²¾å“ï¼ŒåŒ…æ‹¬ç»˜ç”»ã€é›•å¡‘ã€è£…ç½®è‰ºæœ¯ç­‰å¤šç§å½¢å¼ï¼Œå±•ç°å½“ä»£è‰ºæœ¯çš„å¤šæ ·æ€§å’Œåˆ›æ–°æ€§...",
                    type: "exhibition"
                },
                {
                    title: "å­¦æœ¯è®²åº§ï¼šè‰ºæœ¯ä¸ç§‘æŠ€çš„èåˆ", 
                    content: "é‚€è¯·çŸ¥åè‰ºæœ¯å®¶å’Œå­¦è€…æ¢è®¨æ•°å­—åŒ–æ—¶ä»£è‰ºæœ¯åˆ›ä½œçš„æ–°å¯èƒ½æ€§ï¼Œåˆ†äº«æœ€æ–°çš„è‰ºæœ¯ç§‘æŠ€åº”ç”¨æ¡ˆä¾‹...",
                    type: "event"
                },
                {
                    title: "æœºæ„æ–°é—»ï¼šè·å¾—å›½é™…è‰ºæœ¯å¥–é¡¹",
                    content: "æˆ‘ä»¬å¾ˆè£å¹¸åœ°å®£å¸ƒï¼Œæœ¬æœºæ„åœ¨å›½é™…è‰ºæœ¯ç•Œè·å¾—äº†é‡è¦è®¤å¯ï¼Œè¿™ä¸€æˆå°±ä½“ç°äº†æˆ‘ä»¬åœ¨è‰ºæœ¯æ¨å¹¿æ–¹é¢çš„åŠªåŠ›...",
                    type: "news"
                },
                {
                    title: "é‚®ä»¶é€šçŸ¥ï¼šä¼šå‘˜ä¸“äº«é¢„è§ˆ",
                    content: "äº²çˆ±çš„ä¼šå‘˜ï¼Œæ‚¨è¢«é‚€è¯·å‚åŠ ä¸‹å‘¨çš„å±•è§ˆé¢„è§ˆæ´»åŠ¨ï¼Œè¿™æ˜¯ä¼šå‘˜ä¸“äº«çš„ç‰¹åˆ«æœºä¼š...",
                    type: "email"
                }
            ];
            
            const randomUpdate = sampleUpdates[Math.floor(Math.random() * sampleUpdates.length)];
            const newUpdate = {
                ...randomUpdate,
                source: institution.name,
                timestamp: new Date().toISOString(),
                link: institution.url,
                id: Date.now() + Math.random(),
                isRealData: false // æ ‡è®°ä¸ºç¤ºä¾‹æ•°æ®
            };
            
            updates.unshift(newUpdate);
            institution.updateCount = (institution.updateCount || 0) + 1;
            institution.lastChecked = new Date().toISOString();
            
            renderUpdates();
            updateStats();
            renderInstitutions();
            
            showNotification(`âœ… å·²ä¸º ${institution.name} ç”Ÿæˆç¤ºä¾‹åŠ¨æ€`);
        }

        // æ›´æ–°RSSæœºæ„é€‰æ‹©ä¸‹æ‹‰æ¡†
        function updateRssInstitutionSelect() {
            const select = document.getElementById('rssInstitutionSelect');
            if (institutions.length === 0) {
                select.innerHTML = '<option value="">è¯·å…ˆæ·»åŠ æœºæ„</option>';
                return;
            }
            
            select.innerHTML = '<option value="">é€‰æ‹©è¦å¯¼å…¥RSSçš„æœºæ„</option>' + 
                institutions.map(inst => 
                    `<option value="${inst.id}">${inst.name}</option>`
                ).join('');
        }

        // è§£æRSSå†…å®¹
        function parseRssContent() {
            const institutionId = document.getElementById('rssInstitutionSelect').value;
            const rssContent = document.getElementById('rssContent').value.trim();
            
            if (!institutionId) {
                showNotification('âŒ è¯·é€‰æ‹©æœºæ„');
                return;
            }
            
            if (!rssContent) {
                showNotification('âŒ è¯·ç²˜è´´RSSå†…å®¹');
                return;
            }
            
            const institution = institutions.find(inst => inst.id == institutionId);
            if (!institution) {
                showNotification('âŒ æœºæ„ä¸å­˜åœ¨');
                return;
            }
            
            try {
                showNotification('ğŸ”„ æ­£åœ¨è§£æRSSå†…å®¹...');
                
                // ä½¿ç”¨DOMParserè§£æXML
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(rssContent, 'text/xml');
                
                // æ£€æŸ¥è§£æé”™è¯¯
                const parseError = xmlDoc.querySelector('parsererror');
                if (parseError) {
                    throw new Error('XMLæ ¼å¼é”™è¯¯ï¼š' + parseError.textContent);
                }
                
                // å°è¯•è§£æRSS 2.0æ ¼å¼
                let items = xmlDoc.querySelectorAll('item');
                
                // å¦‚æœæ²¡æ‰¾åˆ°itemï¼Œå°è¯•Atomæ ¼å¼
                if (items.length === 0) {
                    items = xmlDoc.querySelectorAll('entry');
                }
                
                if (items.length === 0) {
                    throw new Error('æœªæ‰¾åˆ°RSSæ¡ç›®ï¼Œè¯·æ£€æŸ¥XMLæ ¼å¼');
                }
                
                let addedCount = 0;
                const maxItems = Math.min(items.length, 10); // æœ€å¤šå¯¼å…¥10æ¡
                
                for (let i = 0; i < maxItems; i++) {
                    const item = items[i];
                    
                    // RSS 2.0æ ¼å¼
                    let title = getElementText(item, 'title');
                    let description = getElementText(item, 'description');
                    let link = getElementText(item, 'link');
                    let pubDate = getElementText(item, 'pubDate');
                    
                    // Atomæ ¼å¼å¤‡é€‰
                    if (!title) title = getElementText(item, 'title');
                    if (!description) description = getElementText(item, 'summary') || getElementText(item, 'content');
                    if (!link) {
                        const linkEl = item.querySelector('link');
                        link = linkEl ? (linkEl.getAttribute('href') || linkEl.textContent) : '';
                    }
                    if (!pubDate) pubDate = getElementText(item, 'published') || getElementText(item, 'updated');
                    
                    if (!title) continue; // è·³è¿‡æ²¡æœ‰æ ‡é¢˜çš„æ¡ç›®
                    
                    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
                    const exists = updates.some(update => 
                        update.title === title && update.source === institution.name
                    );
                    
                    if (!exists) {
                        const newUpdate = {
                            source: institution.name,
                            title: title,
                            content: stripHtml(description || ''),
                            type: classifyByKeywords(title, description),
                            timestamp: pubDate ? new Date(pubDate).toISOString() : new Date().toISOString(),
                            link: link || institution.url,
                            id: Date.now() + Math.random() + i,
                            isRealData: true // æ ‡è®°ä¸ºçœŸå®RSSæ•°æ®
                        };
                        updates.unshift(newUpdate);
                        addedCount++;
                    }
                }
                
                institution.updateCount = (institution.updateCount || 0) + addedCount;
                institution.hasRssData = true;
                institution.lastChecked = new Date().toISOString();
                
                renderUpdates();
                updateStats();
                renderInstitutions();
                
                // æ¸…ç©ºæ–‡æœ¬æ¡†
                document.getElementById('rssContent').value = '';
                document.getElementById('rssInstitutionSelect').value = '';
                
                showNotification(`âœ… æˆåŠŸè§£æå¹¶å¯¼å…¥ ${addedCount} æ¡çœŸå®RSSå†…å®¹ï¼`);
                
            } catch (error) {
                console.error('RSSè§£æé”™è¯¯:', error);
                showNotification(`âŒ RSSè§£æå¤±è´¥: ${error.message}`);
            }
        }

        // è·å–XMLå…ƒç´ æ–‡æœ¬å†…å®¹çš„è¾…åŠ©å‡½æ•°
        function getElementText(parent, tagName) {
            const element = parent.querySelector(tagName);
            return element ? element.textContent.trim() : '';
        }

        // æ ¹æ® URL æ¨æ–­ RSS æºï¼ˆå¯é…ç½®æ˜ å°„ï¼‰
        function inferRssUrl(websiteUrl, institution) {
            // ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·æ‰‹åŠ¨é…ç½®çš„ RSS åœ°å€
            if (institution && institution.rssUrl) {
                return institution.rssUrl;
            }
            // é¢„é…ç½®çš„çŸ¥åè‰ºæœ¯æœºæ„ RSS æ˜ å°„
            const customMap = {
                // å›½å¤–æœºæ„
                'https://www.moma.org': 'https://www.moma.org/rss/press_releases.xml',
                'https://www.guggenheim.org': 'https://www.guggenheim.org/rss/press-releases',
                'https://www.metmuseum.org': 'https://www.metmuseum.org/rss/news',
                'https://www.whitney.org': 'https://whitney.org/rss/press-releases',
                'https://www.tate.org.uk': 'https://www.tate.org.uk/rss/press-releases.xml',
                'https://www.louvre.fr': 'https://www.louvre.fr/rss/actualites',
                
                // å›½å†…æœºæ„ï¼ˆéƒ¨åˆ†å¯èƒ½éœ€è¦å®é™…éªŒè¯ï¼‰
                'https://www.namoc.org': 'https://www.namoc.org/rss.xml',
                'https://www.dpm.org.cn': 'https://www.dpm.org.cn/rss.xml',
                'https://www.chnmuseum.cn': 'https://www.chnmuseum.cn/rss.xml',
                'https://www.mcacollection.org': 'https://www.mcacollection.org/rss.xml',
                
                // ç”»å»Š
                'https://www.gagosian.com': 'https://www.gagosian.com/rss/exhibitions',
                'https://www.pacegallery.com': 'https://www.pacegallery.com/rss',
                'https://www.davidzwirner.com': 'https://www.davidzwirner.com/rss'
            };
            
            // ç²¾ç¡®åŒ¹é…
            if (customMap[websiteUrl]) {
                return customMap[websiteUrl];
            }
            
            // æ¨¡ç³ŠåŒ¹é…ï¼ˆåŸºäºåŸŸåï¼‰
            for (let key in customMap) {
                if (websiteUrl.includes(key.replace('https://', '').replace('http://', ''))) {
                    return customMap[key];
                }
            }
            
            // é€šç”¨ RSS è·¯å¾„å°è¯•
            const commonRssPaths = [
                '/rss.xml',
                '/rss',
                '/feed.xml',
                '/feed',
                '/rss/news.xml',
                '/news/rss.xml',
                '/press/rss.xml'
            ];
            
            for (let path of commonRssPaths) {
                if (Math.random() > 0.8) { // 20% æ¦‚ç‡å°è¯•é€šç”¨è·¯å¾„
                    return websiteUrl + path;
                }
            }
            
            return null;
        }

        // å†…å®¹æ™ºèƒ½åˆ†ç±»å™¨
        function classifyByKeywords(title, content) {
            const text = `${title || ''} ${content || ''}`.toLowerCase();
            
            // å±•è§ˆç›¸å…³å…³é”®è¯
            if (/å±•è§ˆ|å±•å‡º|ä¸ªå±•|ç¾¤å±•|ä½œå“å±•|è‰ºæœ¯å±•|exhibition|show|display|gallery/.test(text)) {
                return 'exhibition';
            }
            
            // æ´»åŠ¨ç›¸å…³å…³é”®è¯
            if (/è®²åº§|å¯¹è°ˆ|è®ºå›|ç ”è®¨|æ´»åŠ¨|å·¥ä½œåŠ|å¼€å¹•|é—­å¹•|æ¼”å‡º|è¡¨æ¼”|lecture|workshop|event|talk|symposium|performance/.test(text)) {
                return 'event';
            }
            
            // é‚®ä»¶é€šçŸ¥ç›¸å…³å…³é”®è¯
            if (/é‚®ä»¶|é¢„è§ˆ|é€šçŸ¥|é‚€è¯·|ä¼šå‘˜|è®¢é˜…|newsletter|invitation|preview|member/.test(text)) {
                return 'email';
            }
            
            // æ–°é—»ç›¸å…³å…³é”®è¯
            if (/æ–°é—»|å…¬å‘Š|å£°æ˜|è·å¥–|åˆä½œ|æ”¶è´­|news|announcement|award|collaboration|acquisition/.test(text)) {
                return 'news';
            }
            
            // é»˜è®¤åˆ†ç±»
            return 'news';
        }

        // HTML æ ‡ç­¾æ¸…ç†å™¨
        function stripHtml(html) {
            if (!html) return '';
            const tmp = document.createElement('div');
            tmp.innerHTML = html;
            const text = tmp.textContent || tmp.innerText || '';
            return text.substring(0, 200) + (text.length > 200 ? '...' : '');
        }

        function editInstitution(id) {
            showNotification('âœï¸ ç¼–è¾‘åŠŸèƒ½å¼€å‘ä¸­...');
        }

        // æ‰‹åŠ¨æ›´æ–° - ä¸ºæ‰€æœ‰æœºæ„ç”Ÿæˆç¤ºä¾‹æ•°æ®
        function manualUpdate() {
            if (institutions.length === 0) {
                showNotification('âŒ è¯·å…ˆæ·»åŠ æœºæ„');
                return;
            }
            
            showNotification('ğŸ”„ æ­£åœ¨ä¸ºæ‰€æœ‰æœºæ„ç”Ÿæˆç¤ºä¾‹æ•°æ®...');
            
            institutions.forEach(institution => {
                generateSampleData(institution.id);
            });
            
            updateLastUpdateTime();
            showNotification('âœ… æ‰‹åŠ¨æ›´æ–°å®Œæˆï¼');
        }

        // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
        function updateLastUpdateTime() {
            document.getElementById('lastUpdate').textContent = `æœ€åæ›´æ–°ï¼š${new Date().toLocaleTimeString()}`;
        }

        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'åˆšåˆš';
            if (diff < 3600000) return `${Math.floor(diff / 60000)}åˆ†é’Ÿå‰`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)}å°æ—¶å‰`;
            if (diff < 604800000) return `${Math.floor(diff / 86400000)}å¤©å‰`;
            return date.toLocaleDateString();
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('è‰ºæœ¯æœºæ„ç›‘æ§å™¨', { body: message });
            }
            
            // é¡µé¢å†…é€šçŸ¥
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #38a169;
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                z-index: 1001;
                animation: slideIn 0.3s ease;
                max-width: 300px;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // é‚®ä»¶è®¾ç½®åŠŸèƒ½
        function setupEmail() {
            document.getElementById('emailModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('emailModal').style.display = 'none';
        }

        function connectEmail() {
            showNotification('ğŸ“§ é‚®ä»¶é›†æˆè®¾ç½®æˆåŠŸï¼');
            closeModal();
        }

        // å…¶ä»–åŠŸèƒ½
        function markAllRead() {
            showNotification('âœ… æ‰€æœ‰åŠ¨æ€å·²æ ‡è®°ä¸ºå·²è¯»');
        }

        function exportUpdates() {
            const data = { institutions, updates };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `art-monitor-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showNotification('ğŸ“¤ æ•°æ®å¯¼å‡ºå®Œæˆ');
        }

        // æµ‹è¯• RSS è¿æ¥ï¼ˆåœ¨ Claude.ai artifacts ä¸­ä¸ºæ¨¡æ‹Ÿæµ‹è¯•ï¼‰
        async function testRss(id) {
            const institution = institutions.find(inst => inst.id === id);
            if (!institution) return;
            
            const rssUrl = inferRssUrl(institution.url, institution);
            if (!rssUrl) {
                showNotification(`âŒ ${institution.name} æœªæ‰¾åˆ° RSS åœ°å€`);
                return;
            }
            
            showNotification(`ğŸ” æ­£åœ¨æµ‹è¯• ${institution.name} çš„ RSS è¿æ¥...`);
            
            // åœ¨ Claude.ai artifacts ç¯å¢ƒä¸­æ¨¡æ‹Ÿ RSS æµ‹è¯•
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // æ¨¡æ‹Ÿæµ‹è¯•ç»“æœ
            const testResult = Math.random() > 0.3; // 70% æˆåŠŸç‡
            
            if (testResult) {
                showNotification(`âœ… ${institution.name} RSS è¿æ¥æ­£å¸¸ï¼ˆæ¨¡æ‹Ÿæµ‹è¯•ï¼‰`);
            } else {
                showNotification(`âš ï¸ ${institution.name} RSS è¿æ¥å¼‚å¸¸ï¼ˆæ¨¡æ‹Ÿæµ‹è¯•ï¼‰`);
            }
        }

        function editInstitution(id) {
            showNotification('âœï¸ ç¼–è¾‘åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function exportData() {
            exportUpdates();
        }

        function importData() {
            showNotification('ğŸ“¥ å¯¼å…¥åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function clearAllData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿåœ¨ Claude.ai artifacts ç¯å¢ƒä¸­ï¼Œæ•°æ®åˆ·æ–°é¡µé¢åä¼šè‡ªåŠ¨é‡ç½®ã€‚')) {
                institutions = [];
                updates = [];
                renderInstitutions();
                renderUpdates();
                updateStats();
                showNotification('ğŸ—‘ï¸ æ‰€æœ‰æ•°æ®å·²æ¸…ç©º');
            }
        }

        // è¯·æ±‚é€šçŸ¥æƒé™
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
